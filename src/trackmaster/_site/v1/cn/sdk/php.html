<h1 id='trackmaster_api_php_sdk'>TrackMaster API PHP SDK</h1>

<h3 id='id102'>示例类</h3>

<pre class='prettyprint'><code>class TrackmasterClient {

    function __construct($host, $port = 80) {
        $this-&gt;host = $host;
        $this-&gt;port = $port;
    }

    function get($url) {
       return $this-&gt;send(&quot;GET&quot;, $url);
    }

    function post($url, $data = null) {
        return $this-&gt;send(&quot;POST&quot;, $url, $data);
    }

    function put($url, $data = null) {
        return $this-&gt;send(&quot;PUT&quot;, $url, $data);
    }

    function delete($url) {
        return $this-&gt;send(&quot;DELETE&quot;, $url);
    }

    function send($method, $url, $post_data = NULL) {
        $s = fsockopen($this-&gt;host, $this-&gt;port, $errno, $errstr);
        if(!$s) {
            throw new Exception(&quot;$errno: $errstr&quot;);
        }

        $request = &quot;$method $url HTTP/1.0\r\nHost: $this-&gt;host\r\n&quot;;
        $request .= &quot;User-Agent: TrackMaster-Client-PHP\r\n&quot;;

        if ($post_data) {
            $request .= &quot;Content-Length: &quot;.strlen($post_data).&quot;\r\n\r\n&quot;;
            $request .= &quot;$post_data\r\n&quot;;
        } else {
            $request .= &quot;\r\n&quot;;
        }

        fwrite($s, $request);
        $response = &quot;&quot;;

        while(!feof($s)) {
            $response .= fgets($s);
        }

        list($this-&gt;headers, $this-&gt;body) = explode(&quot;\r\n\r\n&quot;, $response);
        return $this-&gt;body;
    }
}</code></pre>

<h3 id='access_token'>获取access_token</h3>

<pre class='prettyprint'><code>$json = json_encode(array(
  &quot;client_id&quot; =&gt; &quot;***&quot;,
  &quot;client_secret&quot; =&gt; &quot;***&quot;,
  &quot;grant_type&quot; =&gt; &quot;password&quot;,
  &quot;email&quot; =&gt; &quot;***&quot;,
  &quot;password&quot; =&gt; &quot;***&quot;
));

$client = new TrackmasterClient(&quot;open.admaster.com.cn&quot;);
$response = $client-&gt;post(&quot;/oauth/access_token&quot;, $json);</code></pre>

<h3 id='id103'>获取当前用户</h3>

<pre class='prettyprint'><code>$client = new TrackmasterClient(&quot;track.admasterapi.com&quot;);
$response = $client-&gt;get(&quot;/user?access_token=***&quot;);</code></pre>

<h3 id='id104'>获取当前用户网络</h3>

<pre class='prettyprint'><code>$response = $client-&gt;get(&quot;/user/networks?access_token=***&quot;);</code></pre>