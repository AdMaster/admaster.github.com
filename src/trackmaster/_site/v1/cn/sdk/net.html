<h1 id='trackmaster_api_c_sdk'>TrackMaster API C<code>#</code> SDK</h1>

<h3 id='id105'>示例类</h3>

<pre class='prettyprint'><code>using System;
using System.IO;
using System.Net;
using System.Text;
using System.Web;

namespace Admaster{
    public class TrackmasterClient {
        private HttpWebRequest request;

        private string uri;

        public TrackmasterClient(string host)
        {
            this.uri = &quot;http://&quot; + host;
        }

        public HttpWebResponse Request(string method, string path, string data)
        {
            request = (HttpWebRequest)WebRequest.Create(this.uri + path);
            request.Headers.Clear(); //important
            request.Headers.Add(&quot;Accept-Charset&quot;, &quot;utf-8&quot;);
            request.Accept = &quot;application/json&quot;;
            request.Referer= this.uri;
            request.ContentType = &quot;application/json&quot;;
            request.Timeout = 10000;
            request.Method = method;
            return this.GetResponse(request, data);
        }

        public HttpWebResponse Get(string path) {
            return Request(&quot;GET&quot;, path, null);
        }

        public HttpWebResponse Post(string url, string data) {
            return Request(&quot;POST&quot;, url, data);
        }

        public HttpWebResponse Put(string path, string data) {
            return Request(&quot;PUT&quot;, path, data);
        }

        public HttpWebResponse Delete(string path) {
            return Request(&quot;DELETE&quot;, path, null);
        }

        public HttpWebRequest GetRequest() {
            return request;
        }

        public HttpWebResponse GetResponse(HttpWebRequest request, String data)
        {
            if (request.Method == &quot;POST&quot;)
            {
                ASCIIEncoding encoding = new ASCIIEncoding();
                byte[] b = encoding.GetBytes(data);
                request.ContentLength = b.Length;
                using (Stream stream = request.GetRequestStream())
                {
                    stream.Write(b, 0, b.Length);
                }
            }
            try
            {
                HttpWebResponse res = (HttpWebResponse)request.GetResponse();
                return res;
            } catch (WebException webEx) {
                throw webEx;
            }
        }

        public String ResultData(HttpWebResponse response)
        {
            string result = string.Empty;
        try
        {
            using (StreamReader reader = new StreamReader(response.GetResponseStream(), Encoding.GetEncoding(&quot;utf-8&quot;)))
            {
                result = reader.ReadToEnd();
            }
        }
        catch (Exception ex)
        {
            result =&quot;发生异常\n\r&quot; + ex.Message;
        }
        return result;
        }
    }
}</code></pre>

<h3 id='access_token'>获取access_token</h3>

<pre class='prettyprint'><code>String client_id = &quot;\&quot;您的client_id\&quot;&quot;;
String client_secret = &quot;\&quot;您的client_secret\&quot;&quot;;
String grant_type = &quot;\&quot;password\&quot;&quot;;
String password = &quot;\&quot;您的密码\&quot;&quot;;
String email = &quot;\&quot;您的邮箱\&quot;&quot;;
String json = &quot;{\&quot;client_id\&quot;:&quot; + client_id
    + &quot;,\&quot;client_secret\&quot;:&quot; + client_secret
    + &quot;,\&quot;grant_type\&quot;:&quot; + grant_type
    + &quot;,\&quot;email\&quot;:&quot; +email
    + &quot;,\&quot;password\&quot;:&quot; +password+&quot;}&quot;;
TrackmasterClient client = new TrackmasterClient(&quot;testopen.admasterapi.com&quot;);
HttpWebResponse response = client.Post(&quot;/oauth/access_token&quot;, json);
String data = client.ResultData(response);</code></pre>

<h3 id='id106'>获取当前用户</h3>

<pre class='prettyprint'><code>TrackmasterClient client = new TrackmasterClient(&quot;track.admasterapi.com&quot;);
HttpWebResponse response = client.Get(&quot;/user?access_token=***&quot;);
String data = client.ResultData(response);</code></pre>

<h3 id='id107'>获取当前用户网络</h3>

<pre class='prettyprint'><code>TrackmasterClient client = new TrackmasterClient(&quot;track.admasterapi.com&quot;);
HttpWebResponse response = client.Get(&quot;/user/networks?access_token=***&quot;);
String data = client.ResultData(response);</code></pre>