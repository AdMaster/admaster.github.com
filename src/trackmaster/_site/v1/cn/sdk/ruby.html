<h1 id='trackmaster_api_ruby_sdk'>TrackMaster API Ruby SDK</h1>

<h3 id='id108'>示例类</h3>

<pre class='prettyprint'><code>require &#39;net/http&#39;

class TrackmasterClient

  def initialize(host, port = 80, options = nil)
    @host = host
    @port = port
    @options = options
  end

  def delete(uri)
    request(Net::HTTP::Delete.new(uri))
  end

  def get(uri)
    request(Net::HTTP::Get.new(uri))
  end

  def put(uri, json)
    req = Net::HTTP::Put.new(uri)
    req[&quot;content-type&quot;] = &quot;application/json&quot;
    req.body = json
    request(req)
  end

  def post(uri, json)
    req = Net::HTTP::Post.new(uri)
    req[&quot;content-type&quot;] = &quot;application/json&quot;
    req.body = json
    request(req)
  end

  def request(req)
    res = Net::HTTP.start(@host, @port) { |http|http.request(req) }
    unless res.kind_of?(Net::HTTPSuccess)
      handle_error(req, res)
    end
    res
  end

  private

  def handle_error(req, res)
    e = RuntimeError.new(&quot;#{res.code}:#{res.message}\nMETHOD:#{req.method}\nURI:#{req.path}\n#{res.body}&quot;)
    raise e
  end
end</code></pre>

<h3 id='access_token'>获取access_token</h3>

<pre class='prettyprint'><code>json = JSON.generate({
  client_id: &quot;***&quot;,
  client_secret: &quot;***&quot;,
  grant_type: &quot;password&quot;,
  email: &quot;***&quot;,
  password: &quot;***&quot;
})

client = TrackmasterClient.new(&quot;open.admaster.com.cn&quot;)
response = client.post(&quot;/oauth/access_token&quot;, json)</code></pre>

<h3 id='id109'>获取当前用户</h3>

<pre class='prettyprint'><code>client = TrackmasterClient.new(&quot;track.admasterapi.com&quot;)
response = client.get(&quot;/user?access_token=***&quot;)</code></pre>

<h3 id='id110'>获取当前用户网络</h3>

<pre class='prettyprint'><code>response = client.get(&quot;/user/networks?access_token=***&quot;)</code></pre>